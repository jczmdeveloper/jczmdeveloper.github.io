<!DOCTYPE html>
<!-- saved from url=(0039)http://www.tuicool.com/articles/m6RVFfA -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta content="authenticity_token" name="csrf-param">
<meta content="9mdmixnKNwJsdA82PB//jYp9toTMxJPxe+oQTOMlJBY=" name="csrf-token">
    <title>
            谈谈Android App混合开发 - 推酷
   </title>
    <meta name="description" content="谈谈Android App混合开发">
  <link rel="shortcut icon" href="http://static0.tuicool.com/favicon.ico" type="image/x-icon">
  <link href="http://static0.tuicool.com/images/icon114.png" rel="Bookmark">
  <link rel="apple-touch-icon" sizes="57x57" href="http://static1.tuicool.com/images/icon57.png"> 
  <link rel="apple-touch-icon" sizes="72x72" href="http://static2.tuicool.com/images/icon72.png">  
  <link rel="apple-touch-icon" sizes="114x114" href="http://static0.tuicool.com/images/icon114.png">    
  <link rel="apple-touch-icon" sizes="144x144" href="http://static1.tuicool.com/images/icon144.png">  
  <link href="./谈谈Android App混合开发 _files/application-3c98e1b00d584b68900e1daf0ed69192.css" media="screen" rel="stylesheet" type="text/css">
  <link href="http://static0.tuicool.com/assets/font-awesome.min.css" rel="stylesheet">
  <script src="./谈谈Android App混合开发 _files/application-7edeeea3a20493861059090224f774ae.js" type="text/javascript"></script>

  <!--[if IE 7]>
  <link rel="stylesheet" href="http://assets.tuicool.com/assets/font-awesome-ie7.min.css">
  <![endif]--> 
    <script type="text/javascript" src="./谈谈Android App混合开发 _files/tip.js"></script>
  
  <script type="text/javascript" src="./谈谈Android App混合开发 _files/spin.min.js"></script><style type="text/css"></style>
<link rel="stylesheet" href="http://static0.tuicool.com/assets/github.css">

</head>
<body class=" pace-done"><div id="yass_top_edge_dummy" style="width: 1px; height: 1px; padding: 0px; margin: -49.2999992370606px 0px 0px; border-width: 0px; display: block;"></div><div id="yass_top_edge" style="padding: 0px; margin: 0px; border-width: 0px; height: 0px; display: block; width: 1903px; background-image: url(se-extension://ext-1528535222/edgebgtop.png); background-attachment: scroll; background-position: 50% 100%;"></div><div id="yass_top_edge_padding" style="padding: 0px 0px 48.2999992370606px; margin: 0px; border-width: 0px; height: 0px; display: block;"></div><div class="pace  pace-inactive"><div class="pace-progress" data-progress-text="100%" data-progress="99" style="-webkit-transform: translate3d(100%, 0px, 0px); transform: translate3d(100%, 0px, 0px);">
  <div class="pace-progress-inner"></div>
</div>
<div class="pace-activity"></div></div>
  
  <div id="header" class="navbar-fixed-top">
    <div class="container">
      <div class="navbar">
        <div class="navbar-inner">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse"> 
            <span class="icon-bar"></span> 
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span> 
          </a>
          <a href="http://www.tuicool.com/" class="brand">推酷</a>        
        <nav class="nav-collapse collapse">
            <ul class="nav navbar primary-nav">                            
              <li class="active">
                <a href="http://www.tuicool.com/ah">
                  文章
                </a>
              </li>              
              <li class="">
                <a href="http://www.tuicool.com/sites/hot">
                  站点
                </a>
              </li>
              <li class="">
                <a href="http://www.tuicool.com/topics">
                  主题
                </a>
              </li>
              <li class="">
                <a href="http://course.tuicool.com/">
                  公开课
                </a>
              </li>
              <li class="">
                <a href="http://huodong.tuicool.com/">
                  活动
                </a>
              </li>
              <li class="">
                <a href="http://www.tuicool.com/mobile">
                  客户端
                    <sup style="font-size:0.8em;color: #16A085;">荐</sup>
                </a>
              </li>
              <li class="dropdown">
                <a href="http://www.tuicool.com/articles/m6RVFfA#" class="dropdown-toggle" data-toggle="dropdown">周刊 <b class="caret"></b></a>
                <ul class="dropdown-menu">
                  <li><a href="http://www.tuicool.com/mags">编程狂人</a></li>
                  <li><a href="http://www.tuicool.com/mags/design">设计匠艺</a></li> 
                  <li><a href="http://www.tuicool.com/mags/startup">创业周刊</a></li> 
                  <li><a href="http://www.tuicool.com/mags/tech">科技周刊</a></li>      
                  <li><a href="http://www.tuicool.com/mags/guru">Guru Weekly</a></li> 
                  <li><a href="http://www.tuicool.com/articles/weekly">一周拾遗</a></li>                  
                </ul>
              </li>
              
              </ul>
            <form class="navbar-search pull-left" action="http://www.tuicool.com/search">
              <input type="text" class="search-query span2" name="kw" placeholder="搜索">
            </form>
            <ul class="nav pull-right">
                <li><a href="http://www.tuicool.com/login">登录</a></li>
            </ul>
          </nav>
        </div>
      </div>
  </div>   
</div>
  <div id="flash_container" class="noPrint">    
  </div>
  
  <div class="container-fluid">  
      
<div class="row-fluid article_row_fluid">
    <div class="span8 contant article_detail_bg">
        <h1>谈谈Android App混合开发</h1>
        <div class="article_meta">
            <div style="margin-bottom: 5px;">
            <span class="timestamp">时间&nbsp;2015-08-25 20:13:43
            </span>
            <span class="from">
                <i class="icon-globe"></i>
                    <a class="cut cut28 from" href="http://www.tuicool.com/sites/zeYFF3" target="_blank">bxbxbai
                    </a>
            </span>
            </div>
            <div class="source">
                <i style="float:left;">原文</i>&nbsp; 
                <a class="cut cut70" href="http://bxbxbai.gitcafe.io/2015/08/16/talk-about-bybird-app/?utm_source=tuicool&utm_medium=referral" style="display:inline-block;">http://bxbxbai.gitcafe.io/2015/08/16/talk-about-bybird-app/</a>
            </div>
            <div>
                <span>主题</span>
                <a href="http://www.tuicool.com/topics/11060000" target="_blank">
                    <span class="new-label">HTML</span>
                </a>
                <a href="http://www.tuicool.com/topics/10250000" target="_blank">
                    <span class="new-label">Android</span>
                </a>
            </div>
        </div>
        <div class="article_body" id="nei">
            <div> 
 <span itemprop="articleBody"> <p>混合开发的App（Hybrid App）就是在一个App中内嵌一个轻量级的浏览器，一部分原生的功能改为Html 5来开发，这部分功能不仅能够在不升级App的情况下动态更新，而且可以在Android或iOS的App上同时运行，让用户的体验更好又可以节省开发的资源。</p> <p>下面来谈谈Hybrid App开发中的技术问题。iOS方面的我不太了解，我就主要谈谈Android开发中的，其中可能会有很多说错的，请大家轻喷</p> <h2>Hybrid开发中关键问题是什么</h2> <p>想要在一个App中显示一个Html 5网页的功能，其实很简单，只要一个WebView就可以了。你可以点击链接来跳转网页。像这样的功能就能叫做Hybrid 开发了嘛？显然不是的。</p> <p> 我觉得一个Hybrid开发的App中必须要要有的功能就是Html 5页面和Native App怎么进行交互。比如，我点了一个Html 5页面上的一个按钮或链接，我能不能够跳转到Native App的某个页面；比如我点了Html 5页面上的分享按钮，我能不能调用Native App的分享功能；比如Html加载的时候能不能获取Native App的用户信息等等。 </p> <p> 看下图，在网易云音乐中进入这个Html 5页面时，你点击 <strong>作者：空虚小编</strong> 你会进入他的主页，这个主页是Native页面，而你点击上面那个播放按钮时，云音乐会启动Native的播放界面播放音乐，你点击评论时，你会进入Native的评论页 </p> <p> <img src="./谈谈Android App混合开发 _files/J3mIZzU.png!web" class="alignCenter"> </p> <h2>Html 5和Native的交互</h2> <p> <code>WebView</code> 本来就支持js和Java相互调用，你只需要开启 <code>WebView</code> 的JavaScript脚本执行，然后通过代码 <code>mWebView.addJavascriptInterface(new JsBridge(), "bxbxbai");</code> 向Html 5页面时注入一个Java对象，然后就可以在Html 5页面中调用Native的功能了 </p> <h2>微信怎么做的</h2> <p>微信应该是Hybrid 开发做的最好的App之一，它是怎么做交互的呢？</p> <p> 答案就是 <code>微信JS-SDK</code> ，去微信开发者文档中可以看到，微信JS-SDK封装了各种微信的功能，比如分享到朋友圈，图像接口，音频接口，支付接口地理位置接口等等。开发者只需要调用微信JS-SDK中的函数，然后统一由JS-SDK来调用微信中的功能，这样好处就是我写了一个Html 5的应用或网页，在Android和iOS的微信中都可以正常运行了 </p> <p>下面会详细讲到</p> <h2>网易云音乐怎么做的</h2> <p> 那么网易云音乐是怎么做的呢？我用黑科技知道了上图云音乐的界面Activity是 <code>CommonSubjectActivity</code> （名字好奇怪，如果要我从代码里找，我肯定找不到，因为还有一个类叫做 <code>EmbedBrowserActivity</code> ），我就在反编译后的云音乐代码中找相应的功能实现代码，实在没找到。不过我拿到了那个Html 5页面的地址： <a href="http://music.163.com/m/topic/194001" target="_blank" rel="nofollow,noindex">http://music.163.com/m/topic/194001</a> </p> <p> 用Chrome打开后发现和App中显示的不一样，然后我用Charles截了进入那个Html 5的请求，发现云音乐加载的地址是 <a href="http://music.163.com/m/topic/194001?type=android" target="_blank" rel="nofollow,noindex">http://music.163.com/m/topic/194001?type=android</a> ，就是加了手机系统类型 </p> <p> 然后在我自己的App中加载这个Html 5页面就可以看到下图， <strong>@小比比说</strong> 这样的文字是可以点击跳转到个人，点击播放按钮是可以播放音乐的 </p> <p> <img src="./谈谈Android App混合开发 _files/3qemieB.png!web" class="alignCenter"> </p> <p>从Html源代码中可以看到如下信息：</p> <p> <img src="./谈谈Android App混合开发 _files/yqmMJf.png!web" class="alignCenter"> </p> <p> 也就是说，当我点击一个用户名的时候就请求跳转到 <code>orpheus://user/30868859</code> ，因为WebView可以拦截跳转的url，所以App在拦截每一个url，如果host是 <code>orpheus</code> 的话就启动用户首页 </p> <p> 反编译代码后，在云音乐的代码中找到了 <code>this.mWebView.setWebViewClient(new cf(this));</code> 这么一句代码，进入 <code>cf</code> 类，发现下面代码： </p> <pre class="prettyprint java"><code><span class="keyword">public</span> <span class="keyword">boolean</span> shouldOverrideUrlLoading<span>(WebView webView, String url)</span> {
<span class="indent">  </span><span><span class="keyword">if</span></span> <span>(url.startsWith<span>(<span><span class="string">"orpheus://"</span></span>)</span>)</span> {
<span class="indent">  </span><span class="indent">  </span>RedirectActivity.a<span>(<span class="keyword">this</span>.activity, url)</span>;
<span class="indent">  </span><span class="indent">  </span><span class="keyword">return</span> <span><span class="keyword">true</span></span>;
<span class="indent">  </span>}
<span class="indent">  </span><span><span class="keyword">if</span></span> <span>(<span>(url.toLowerCase<span>()</span>.startsWith<span>(<span><span class="string">"http://"</span></span>)</span>)</span> || <span>(url.toLowerCase<span>()</span>.startsWith<span>(<span><span class="string">"https://"</span></span>)</span>)</span>)</span> {
<span class="indent">  </span><span class="indent">  </span><span class="keyword">return</span> <span><span class="keyword">false</span></span>;
<span class="indent">  </span>}
<span class="indent">  </span><span class="keyword">try</span> {
<span class="indent">  </span><span class="indent">  </span><span class="keyword">this</span>.activity.startActivity<span>(<span class="keyword">new</span> Intent<span>(<span><span class="string">"android.intent.action.VIEW"</span></span>, Uri.parse<span>(url)</span>)</span>)</span>;
<span class="indent">  </span><span class="indent">  </span><span class="keyword">return</span> <span><span class="keyword">true</span></span>;
<span class="indent">  </span>} <span class="keyword">catch</span> <span>(ActivityNotFoundException localActivityNotFoundException)</span> {
<span class="indent">  </span><span class="indent">  </span>localActivityNotFoundException.printStackTrace<span>()</span>;
<span class="indent">  </span>}
<span class="indent">  </span><span class="keyword">return</span> <span><span class="keyword">true</span></span>;
}
</code>
</pre> <p> 果然如此，再进入 <code>RedirectActivity</code> ，这是一个没有任何界面的Activity，专门用于处理页面跳转信息，它会调用一个方法 <code>NeteaseMusicUtils.redirect(this, getIntent().getData().toString(), false)</code> 来处理url， <code>redirect</code> 方法的名字是我自己写的，部分代码如下： </p> <p> <img src="./谈谈Android App混合开发 _files/RVJnM32.png!web" class="alignCenter"> </p> <p> 可以看到 <code>orpheus://user/30868859</code> 中的用户id被传入了 <code>ProfileAcvitiy</code> ，因此启动了用户首页显示了用户信息 </p> <p>然后我自己写了代码拦截Html 5的跳转，打印出的Log如下：</p> <p> <img src="./谈谈Android App混合开发 _files/qqimUzm.png!web" class="alignCenter"> </p> <p>可以看到Html 5页面可以跳转到各种页面，比如用户首页、播放音乐、MV界面、评论页、电台节目等等</p> <h2>总结</h2> <p>一般来讲，也是我目前知道的两种主流的方式就是</p> 
  <ol> 
   <li>js调用Native中的代码</li> 
   <li>Schema：WebView拦截页面跳转</li> 
  </ol> <p>第2种方式实现起来很简单，但是一个致命的问题就是这种交互方式是单向的，Html 5无法实现回调。像云音乐App中这种点击跳转到具体页面的功能，Schema的方式确实可以简单实现，而且也非常适合。如果需求变得复杂，假如Html 5需要获取Native App中的用户信息，那么最好使用js调用的方式。</p> <h2>js和Native进行交互</h2> <p> 上面讲到WebViewbe本身就是支持js调用Native代码的，不过WebView的这个功能在Android 4.2（API 17）一下存在高危的漏洞。这个漏洞的原理就是Android系统通过 <code>WebView.addJavascriptInterface(Object o, String interface)</code> 方法注册可供js调用的Java对象，但是系统并没有对注册的Java对象方法调用做限制。导致攻击者可以利用反射调用未注册的其他任何Java对象，攻击者可以根据客户端的能力做任何事情。 <a href="http://jaq.alibaba.com/blog.htm?id=48" target="_blank" rel="nofollow,noindex">这篇文章</a> 详细的介绍了这个漏洞 </p> <p> 出于安全考虑，Android 4.2以后的系统规定允许被js调用的Java方法必须以 <code>@JavascriptInterface</code> 进行注解 </p> <h2>Cordova的解决方案</h2> <p>Cordova是一个广泛使用的Hybrid开发框架，它提供了一套js和Native交互规范</p> <p> 在Cordova的 <code>SystemWebViewEngine</code> 类中可以看到 </p> <pre class="prettyprint cs"><code><span><span class="keyword">private</span></span> <span><span class="keyword">static</span></span> <span><span><span class="keyword">void</span></span> <span>exposeJsInterface</span><span>(WebView webView, CordovaBridge bridge)</span> </span>{
<span class="indent">  </span><span><span class="keyword">if</span></span> ((Build.VERSION.SDK_INT &lt; Build.VERSION_CODES.JELLY_BEAN_MR1)) {
<span class="indent">  </span><span class="indent">  </span>Log.i(TAG, <span><span class="string">"Disabled addJavascriptInterface() bridge since Android version is old."</span></span>);
<span class="indent">  </span><span class="indent">  </span><span><span class="comment">// Bug being that Java Strings do not get converted to JS strings automatically.</span></span>
<span class="indent">  </span><span class="indent">  </span><span><span class="comment">// This isn't hard to work-around on the JS side, but it's easier to just</span></span>
<span class="indent">  </span><span class="indent">  </span><span><span class="comment">// use the prompt bridge instead.</span></span>
<span class="indent">  </span><span class="indent">  </span><span><span class="keyword">return</span></span>;
<span class="indent">  </span>}
<span class="indent">  </span>webView.addJavascriptInterface(<span><span class="keyword">new</span></span> SystemExposedJsApi(bridge), <span><span class="string">"_cordovaNative"</span></span>);
}
</code>
</pre> <p> 因此当Android系统高于4.2时，Cordova还是使用 <code>addJavascriptInterface</code> 这种方式，因为这个方法在高版本上安全而且简单，低于4.2的时候，用什么方法呢？ </p> <p> 答案是 <code>WebChromeClient.onJsPrompt</code> 方法 </p> <p> WebView可以设置一个 <code>WebChromeClient</code> 对象，它可以处理js的3个方法 </p> 
  <ul> 
   <li> <code>onJsAlert</code> </li> 
   <li> <code>onJsConfirm</code> </li> 
   <li> <code>onJsPrompt</code> </li> 
  </ul> <p> 这3个方法分别对应js的 <code>alert</code> 、 <code>confirm</code> 、 <code>prompt</code> 方法，因为只有 <code>prompt</code> 接收返回值，所以js调用一个Native方法后可以等待Native返回一个参数。下面是 <code>cordova.js</code> 中的一段代码： </p> <pre class="prettyprint java"><code><span><span class="javadoc">/**
* Implements the API of ExposedJsApi.java, but uses prompt() to communicate.
* This is used pre-JellyBean, where addJavascriptInterface() is disabled.
*/</span></span>
<span>module</span>.exports = {
<span class="indent">  </span>exec: <span><span>function</span>(<span>bridgeSecret, service, action, callbackId, argsJson</span>) </span>{
<span class="indent">  </span><span class="indent">  </span><span><span class="keyword">return</span></span> prompt(argsJson, <span><span class="string">'gap:'</span></span>+<span>JSON</span>.stringify([bridgeSecret, service, action, callbackId]));
<span class="indent">  </span>},
<span class="indent">  </span>setNativeToJsBridgeMode: <span><span>function</span>(<span>bridgeSecret, value</span>) </span>{
<span class="indent">  </span><span class="indent">  </span>prompt(value, <span><span class="string">'gap_bridge_mode:'</span></span> + bridgeSecret);
<span class="indent">  </span>},
<span class="indent">  </span>retrieveJsMessages: <span><span>function</span>(<span>bridgeSecret, fromOnlineEvent</span>) </span>{
<span class="indent">  </span><span class="indent">  </span><span><span class="keyword">return</span></span> prompt(+fromOnlineEvent, <span><span class="string">'gap_poll:'</span></span> + bridgeSecret);
<span class="indent">  </span>}
};
</code>
</pre> <p> 然后只要在 <code>onJsPrompt</code> 方法中使用 <code>CordovaBridge</code> 来处理js的prompt调用 </p> <pre class="prettyprint java"><code><span class="javadoc">/**
 * <span>Tell</span> the client to display a prompt dialog to the user. <span>If</span> the client returns <span>true</span>, <span>WebView</span> will assume that the client will handle the prompt dialog <span>and</span> call the appropriate <span>JsPromptResult</span> <span>method</span>.
 * &lt;p/&gt;
 * <span>Since</span> we are hacking prompts <span>for</span> our own purposes, we should <span>not</span> be <span>using</span> them <span>for</span> this purpose, perhaps we should hack console.log to <span>do</span> this instead!
 */</span>
<span class="annotation">@<span>Override</span></span><span></span>
<span class="keyword">public</span> <span class="keyword">boolean</span> onJsPrompt(<span>WebView</span> view, <span>String</span> origin, <span>String</span> message, <span>String</span> defaultValue, <span class="keyword">final</span> <span>JsPromptResult</span> <span>result</span>) {
<span class="indent">  </span><span class="comment">// <span>Unlike</span> the @<span>JavascriptInterface</span> bridge, this <span>method</span> <span>is</span> always called on the <span>UI</span> thread.</span>
<span class="indent">  </span><span>String</span> handledRet = parentEngine.bridge.promptOnJsPrompt(origin, message, defaultValue);
<span class="indent">  </span><span><span class="keyword">if</span></span> (handledRet != <span class="keyword">null</span>) {
<span class="indent">  </span><span class="indent">  </span><span>result</span>.confirm(handledRet);
<span class="indent">  </span>} <span><span class="keyword">else</span></span> {
<span class="indent">  </span><span class="indent">  </span>dialogsHelper.showPrompt(message, defaultValue, <span class="keyword">new</span> <span>CordovaDialogsHelper</span>.<span>Result</span>() {
<span class="indent">  </span><span class="indent">  </span><span class="indent">  </span><span class="annotation">@<span>Override</span></span><span></span>
<span class="indent">  </span><span class="indent">  </span><span class="indent">  </span><span class="keyword">public</span> <span><span class="keyword">void</span></span> gotResult(<span class="keyword">boolean</span> success, <span>String</span> value) {
<span class="indent">  </span><span class="indent">  </span><span class="indent">  </span><span class="indent">  </span><span><span class="keyword">if</span></span> (success) {
<span class="indent">  </span><span class="indent">  </span><span class="indent">  </span><span class="indent">  </span><span class="indent">  </span><span>result</span>.confirm(value);
<span class="indent">  </span><span class="indent">  </span><span class="indent">  </span><span class="indent">  </span>} <span><span class="keyword">else</span></span> {
<span class="indent">  </span><span class="indent">  </span><span class="indent">  </span><span class="indent">  </span><span class="indent">  </span><span>result</span>.cancel();
<span class="indent">  </span><span class="indent">  </span><span class="indent">  </span><span class="indent">  </span>}
<span class="indent">  </span><span class="indent">  </span><span class="indent">  </span>}
<span class="indent">  </span><span class="indent">  </span>});
<span class="indent">  </span>}
<span class="indent">  </span><span><span class="keyword">return</span></span> <span><span class="keyword">true</span></span>;
}
</code>
</pre> <h2>一种开源的解决方案</h2> <p> Cordova是Apache的一个开源解决方案，不过它需要xml配置 <code>CordovaPlugin</code> 信息，使用会比较麻烦，而且这个框架很重，具体请自行搜索Cordova使用教程 </p> <p>下面这个开源项目是我个人觉得比较合理的解决方案，也比较轻量级，下图就是一个Demo</p> <p> <a href="https://github.com/pedant/safe-java-js-webview-bridge" target="_blank" rel="nofollow,noindex">https://github.com/pedant/safe-java-js-webview-bridge</a> </p> <p> <img src="./谈谈Android App混合开发 _files/V3eaEf.png!web" class="alignCenter"> </p> <p> 这个项目的原理就是使用 <code>WebChromeClient.onJsPrompt</code> 方法来进行交互，本质上都是js调用 <code>prompt</code> 函数，传输一些参数， <code>onJsPrompt</code> 方法拦截到prompt动作，然后解析数据，最后调用相应的Native方法 </p> <p> HostJsScope类中定义了所有可以被js调用的方法，这些方法都必须是静态方法，并且所有的方法第一个参数必须是WebView </p> <pre class="prettyprint java"><code><span><span class="javadoc">/**
* HostJsScope中需要被JS调用的函数，必须定义成public static，且必须包含WebView这个参数
*/</span></span>
<span><span class="keyword">public</span></span> <span><span><span class="class"><span class="keyword">class</span></span></span><span class="class"> <span><span class="title">HostJsScope</span></span> </span></span><span class="class">{</span>
<span class="indent">  </span><span><span class="javadoc">/**
<span class="indent">  </span>* 短暂气泡提醒
<span class="indent">  </span>* <span><span class="javadoctag">@param</span></span> webView 浏览器
<span class="indent">  </span>* <span><span class="javadoctag">@param</span></span> message 提示信息
<span class="indent">  </span>* */</span></span>
<span class="indent">  </span><span><span><span class="keyword">public</span></span> <span><span class="keyword">static</span></span> <span><span class="keyword">void</span></span> <span>toast</span><span>(WebView webView, String message)</span> </span>{
<span class="indent">  </span><span class="indent">  </span>Toast.makeText(webView.getContext(), message, Toast.LENGTH_SHORT).show();
<span class="indent">  </span>}
<span class="indent">  </span><span><span class="javadoc">/**
<span class="indent">  </span>* 系统弹出提示框
<span class="indent">  </span>* <span><span class="javadoctag">@param</span></span> webView 浏览器
<span class="indent">  </span>* <span><span class="javadoctag">@param</span></span> message 提示信息
<span class="indent">  </span>* */</span></span>
<span class="indent">  </span><span><span><span class="keyword">public</span></span> <span><span class="keyword">static</span></span> <span><span class="keyword">void</span></span> <span>alert</span><span>(WebView webView, String message)</span> </span>{
<span class="indent">  </span><span class="indent">  </span><span><span class="comment">// 构建一个Builder来显示网页中的alert对话框</span></span>
<span class="indent">  </span><span class="indent">  </span>AlertDialog.Builder builder = <span><span class="keyword">new</span></span> AlertDialog.Builder(webView.getContext());
<span class="indent">  </span><span class="indent">  </span>builder.setPositiveButton(android.R.string.ok, <span><span class="keyword">new</span></span> AlertDialog.OnClickListener() {
<span class="indent">  </span><span class="indent">  </span><span class="indent">  </span><span><span class="annotation">@Override</span></span>
<span class="indent">  </span><span class="indent">  </span><span class="indent">  </span><span><span><span class="keyword">public</span></span> <span><span class="keyword">void</span></span> <span>onClick</span><span>(DialogInterface dialog, <span><span class="keyword">int</span></span> which)</span> </span>{
<span class="indent">  </span><span class="indent">  </span><span class="indent">  </span><span class="indent">  </span>dialog.dismiss();
<span class="indent">  </span><span class="indent">  </span><span class="indent">  </span>}
<span class="indent">  </span><span class="indent">  </span>});
<span class="indent">  </span><span class="indent">  </span>builder.setTitle(<span><span class="string">"Hello world"</span></span>)
<span class="indent">  </span><span class="indent">  </span><span class="indent">  </span>.setMessage(message)
<span class="indent">  </span><span class="indent">  </span><span class="indent">  </span>.setCancelable(<span><span class="keyword">false</span></span>)
<span class="indent">  </span><span class="indent">  </span><span class="indent">  </span>.create()
<span class="indent">  </span><span class="indent">  </span><span class="indent">  </span>.show();
<span class="indent">  </span>}
<span class="indent">  </span><span><span class="comment">// 其他代码</span></span>
}
</code>
</pre> <p>上面代码列举了最基本的点击Html 5按钮弹出对话框的功能</p> <p> 这个库中一个最关键的叫做 <code>JsCallJava</code> ，这个实现的就是js来调用Java方法的功能，这个类只用于 <code>InjectedWebChromeClient</code> 类 </p> <pre class="prettyprint java"><code><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span><span class="title">InjectedChromeClient</span></span> <span class="keyword">extends</span> <span><span class="title">WebChromeClient</span></span> {</span>
<span class="indent">  </span><span class="keyword">private</span> <span>JsCallJava</span> mJsCallJava;
<span class="indent">  </span><span class="keyword">private</span> <span class="keyword">boolean</span> mIsInjectedJS;
<span class="indent">  </span><span class="keyword">public</span> <span>InjectedChromeClient</span>(<span>String</span> injectedName, <span>Class</span> injectedCls) {
<span class="indent">  </span><span class="indent">  </span><span class="keyword">this</span>(<span class="keyword">new</span> <span>JsCallJava</span>(injectedName, injectedCls));
<span class="indent">  </span>}
<span class="indent">  </span><span class="keyword">public</span> <span>InjectedChromeClient</span>(<span>JsCallJava</span> jsCallJava) {
<span class="indent">  </span><span class="indent">  </span>mJsCallJava = jsCallJava;
<span class="indent">  </span>}
<span class="indent">  </span><span class="comment">// 处理<span>Alert</span>事件</span>
<span class="indent">  </span><span class="annotation">@<span>Override</span></span><span></span>
<span class="indent">  </span><span class="keyword">public</span> <span class="keyword">boolean</span> onJsAlert(<span>WebView</span> view, <span>String</span> url, <span>String</span> message, <span class="keyword">final</span> <span>JsResult</span> <span>result</span>) {
<span class="indent">  </span><span class="indent">  </span><span>result</span>.confirm();
<span class="indent">  </span><span class="indent">  </span><span><span class="keyword">return</span></span> <span><span class="keyword">true</span></span>;
<span class="indent">  </span>}
<span class="indent">  </span><span class="annotation">@<span>Override</span></span><span></span>
<span class="indent">  </span><span class="keyword">public</span> <span><span class="keyword">void</span></span> onProgressChanged(<span>WebView</span> view, <span><span class="keyword">int</span></span> newProgress) {
<span class="indent">  </span><span class="indent">  </span><span class="comment">//为什么要在这里注入<span>JS</span></span><span></span>
<span class="indent">  </span><span class="indent">  </span><span class="comment">//<span>1</span> <span>OnPageStarted</span>中注入有可能全局注入不成功，导致页面脚本上所有接口任何时候都不可用</span>
<span class="indent">  </span><span class="indent">  </span><span class="comment">//<span>2</span> <span>OnPageFinished</span>中注入，虽然最后都会全局注入成功，但是完成时间有可能太晚，当页面在初始化调用接口函数时会等待时间过长</span>
<span class="indent">  </span><span class="indent">  </span><span class="comment">//<span>3</span> 在进度变化时注入，刚好可以在上面两个问题中得到一个折中处理</span>
<span class="indent">  </span><span class="indent">  </span><span class="comment">//为什么是进度大于<span>25</span>%才进行注入，因为从测试看来只有进度大于这个数字页面才真正得到框架刷新加载，保证<span>100</span>%注入成功</span>
<span class="indent">  </span><span class="indent">  </span><span><span class="keyword">if</span></span> (newProgress &lt;= <span><span class="number">25</span></span>) {
<span class="indent">  </span><span class="indent">  </span><span class="indent">  </span>mIsInjectedJS = <span><span class="keyword">false</span></span>;
<span class="indent">  </span><span class="indent">  </span>} <span><span class="keyword">else</span></span> <span><span class="keyword">if</span></span> (!mIsInjectedJS) {
<span class="indent">  </span><span class="indent">  </span><span class="indent">  </span>view.loadUrl(mJsCallJava.getPreloadInterfaceJS());
<span class="indent">  </span><span class="indent">  </span><span class="indent">  </span>mIsInjectedJS = <span><span class="keyword">true</span></span>;
<span class="indent">  </span><span class="indent">  </span><span class="indent">  </span><span>StopWatch</span>.log(<span><span class="string">" inject js interface completely on progress "</span></span> + newProgress);
<span class="indent">  </span><span class="indent">  </span>}
<span class="indent">  </span><span class="indent">  </span><span class="keyword">super</span>.onProgressChanged(view, newProgress);
<span class="indent">  </span>}
<span class="indent">  </span><span class="annotation">@<span>Override</span></span><span></span>
<span class="indent">  </span><span class="keyword">public</span> <span class="keyword">boolean</span> onJsPrompt(<span>WebView</span> view, <span>String</span> url, <span>String</span> message, <span>String</span> defaultValue, <span>JsPromptResult</span> <span>result</span>) {
<span class="indent">  </span><span class="indent">  </span><span>result</span>.confirm(mJsCallJava.call(view, message));
<span class="indent">  </span><span class="indent">  </span><span>StopWatch</span>.log(<span><span class="string">"onJsPrompt: "</span></span> + view.toString() +<span><span class="string">", "</span></span> + url +<span><span class="string">", "</span></span> + message +<span><span class="string">", "</span></span> + defaultValue + <span><span class="string">", "</span></span> + <span>result</span>) ;
<span class="indent">  </span><span class="indent">  </span><span><span class="keyword">return</span></span> <span><span class="keyword">true</span></span>;
<span class="indent">  </span>}
}   
</code>
</pre> <p> 这个 <code>InjectedWebChromeClient</code> 是设给WebView的，这里一个非常重要的细节需要注意一下，在 <code>onProgressChange</code> 方法中，向WebView注入了一段js代码，这段js代码如下： </p> <pre class="prettyprint javascript"><code>javascript: (<span class="keyword">function</span>(b) {
<span class="indent">  </span>console.<span>log</span>(<span><span class="string">"HostApp initialization begin"</span></span>);
<span class="indent">  </span><span><span class="keyword">var</span></span> a = {
<span class="indent">  </span><span class="indent">  </span>queue: [],
<span class="indent">  </span><span class="indent">  </span>callback: <span class="keyword">function</span>() {
<span class="indent">  </span><span class="indent">  </span><span class="indent">  </span><span><span class="keyword">var</span></span> <span>d</span> = Array.prototype.slice.call(arguments, <span class="number">0</span>);
<span class="indent">  </span><span class="indent">  </span><span class="indent">  </span><span><span class="keyword">var</span></span> c = <span>d</span>.shift();
<span class="indent">  </span><span class="indent">  </span><span class="indent">  </span><span><span class="keyword">var</span></span> <span>e</span> = <span>d</span>.shift();
<span class="indent">  </span><span class="indent">  </span><span class="indent">  </span><span class="keyword">this</span>.queue[c].apply(<span class="keyword">this</span>, <span>d</span>);
<span class="indent">  </span><span class="indent">  </span><span class="indent">  </span><span><span class="keyword">if</span></span> (!<span>e</span>) {
<span class="indent">  </span><span class="indent">  </span><span class="indent">  </span><span class="indent">  </span><span class="keyword">delete</span> <span class="keyword">this</span>.queue[c]
<span class="indent">  </span><span class="indent">  </span><span class="indent">  </span>}
<span class="indent">  </span><span class="indent">  </span>}
<span class="indent">  </span>};
<span class="indent">  </span>a.alert = a.alert = a.alert = a.delayJsCallBack = a.getIMSI = a.getOsSdk = a.goBack = a.overloadMethod = a.overloadMethod 
<span class="indent">  </span><span class="indent">  </span>= a.passJson2Java = a.passLongType = a.retBackPassJson = a.retJavaObject = a.testLossTime = a.toast = a.toast = <span class="keyword">function</span>() {
<span class="indent">  </span><span class="indent">  </span><span><span class="keyword">var</span></span> f = Array.prototype.slice.call(arguments, <span class="number">0</span>);
<span class="indent">  </span><span class="indent">  </span><span><span class="keyword">if</span></span> (f.length &lt; <span class="number">1</span>) {
<span class="indent">  </span><span class="indent">  </span><span class="indent">  </span><span class="keyword">throw</span> <span><span class="string">"HostApp call error, message:miss method name"</span></span>
<span class="indent">  </span><span class="indent">  </span>}
<span class="indent">  </span><span class="indent">  </span><span><span class="keyword">var</span></span> <span>e</span> = [];
<span class="indent">  </span><span class="indent">  </span><span><span class="keyword">for</span></span> (<span><span class="keyword">var</span></span> <span>h</span> = <span class="number">1</span>; <span>h</span> &lt; f.length; <span>h</span>++) {
<span class="indent">  </span><span class="indent">  </span><span class="indent">  </span><span><span class="keyword">var</span></span> c = f[<span>h</span>];
<span class="indent">  </span><span class="indent">  </span><span class="indent">  </span><span><span class="keyword">var</span></span> j = <span><span class="keyword">typeof</span></span> c;
<span class="indent">  </span><span class="indent">  </span><span class="indent">  </span><span>e</span>[<span>e</span>.length] = j;
<span class="indent">  </span><span class="indent">  </span><span class="indent">  </span><span><span class="keyword">if</span></span> (j == <span><span class="string">"function"</span></span>) {
<span class="indent">  </span><span class="indent">  </span><span class="indent">  </span><span class="indent">  </span><span><span class="keyword">var</span></span> <span>d</span> = a.queue.length;
<span class="indent">  </span><span class="indent">  </span><span class="indent">  </span><span class="indent">  </span>a.queue[<span>d</span>] = c;
<span class="indent">  </span><span class="indent">  </span><span class="indent">  </span><span class="indent">  </span>f[<span>h</span>] = <span>d</span>
<span class="indent">  </span><span class="indent">  </span><span class="indent">  </span>}
<span class="indent">  </span><span class="indent">  </span>}
<span class="indent">  </span><span class="indent">  </span><span><span class="keyword">var</span></span> <span>g</span> = JSON.<span>parse</span>(prompt(JSON.stringify({
<span class="indent">  </span><span class="indent">  </span><span class="indent">  </span>method: f.shift(),
<span class="indent">  </span><span class="indent">  </span><span class="indent">  </span>types: <span>e</span>,
<span class="indent">  </span><span class="indent">  </span><span class="indent">  </span><span>args</span>: <span>f</span>
<span class="indent">  </span><span class="indent">  </span>})));
<span class="indent">  </span><span class="indent">  </span><span><span class="keyword">if</span></span> (<span>g</span>.code != <span class="number">200</span>) {
<span class="indent">  </span><span class="indent">  </span><span class="indent">  </span><span class="keyword">throw</span> <span><span class="string">"HostApp call error, code:"</span></span> + <span>g</span>.code + <span><span class="string">", message:"</span></span> + <span>g</span>.result
<span class="indent">  </span><span class="indent">  </span>}
<span class="indent">  </span><span class="indent">  </span><span><span class="keyword">return</span></span> <span>g</span>.result
<span class="indent">  </span>};
<span class="indent">  </span><span><span class="comment">//有时候，我们希望在该方法执行前插入一些其他的行为用来检查当前状态或是监测</span></span>
<span class="indent">  </span><span><span class="comment">//代码行为，这就要用到拦截（Interception）或者叫注入（Injection）技术了</span></span>
<span class="indent">  </span><span><span class="comment">/**
<span class="indent">  </span> * Object.getOwnPropertyName 返回一个数组，内容是指定对象的所有属性
<span class="indent">  </span> *
<span class="indent">  </span> * 其后遍历这个数组，分别做以下处理：
<span class="indent">  </span> * 1. 备份原始属性；
<span class="indent">  </span> * 2. 检查属性是否为 function（即方法）；
<span class="indent">  </span> * 3. 若是重新定义该方法，做你需要做的事情，之后 apply 原来的方法体。
<span class="indent">  </span> */</span></span>
<span class="indent">  </span>Object.getOwnPropertyNames(a).<span>forEach</span>(<span class="keyword">function</span>(<span>d</span>) {
<span class="indent">  </span><span class="indent">  </span><span><span class="keyword">var</span></span> c = a[<span>d</span>];
<span class="indent">  </span><span class="indent">  </span><span><span class="keyword">if</span></span> (<span><span class="keyword">typeof</span></span> c === <span><span class="string">"function"</span></span> &amp;&amp; <span>d</span> !== <span><span class="string">"callback"</span></span>) {
<span class="indent">  </span><span class="indent">  </span><span class="indent">  </span>a[<span>d</span>] = <span class="keyword">function</span>() {
<span class="indent">  </span><span class="indent">  </span><span class="indent">  </span><span class="indent">  </span><span><span class="keyword">return</span></span> c.apply(a, [<span>d</span>].concat(Array.prototype.slice.call(arguments, <span class="number">0</span>)))
<span class="indent">  </span><span class="indent">  </span><span class="indent">  </span>}
<span class="indent">  </span><span class="indent">  </span>}
<span class="indent">  </span>});
<span class="indent">  </span>b.HostApp = a;
<span class="indent">  </span>console.<span>log</span>(<span><span class="string">"HostApp initialization end"</span></span>)
})(<span>window</span>);
</code>
</pre> <p> 那么这段js代码是如何生成的呢？答案就在 <code>JsCallJava</code> 类的构造函数方法中，这个构造方法做的事情就是解析 <code>HostJsScope</code> 类中的方法，把每一个方法的签名都保持到 <code>private Map&lt;String, Method&gt; mMethodsMap</code> 中，再看上面那段js代码中 </p> 
  <div> 
   <p>a.alert = a.alert = a.alert = a.delayJsCallBack = a.getIMSI = a.getOsSdk = a.goBack = a.overloadMethod = a.overloadMethod= a.passJson2Java = a.passLongType = a.retBackPassJson = a.retJavaObject = a.testLossTime = a.toast = a.toast = function() </p> 
  </div> <p> 这些都是 <code>HostJsScope</code> 类中定义的方法名 </p> <p>那么这个库的整个执行流程是这样的：</p> 
  <ol> 
   <li> <code>JsCallJava</code> 类解析了 <code>HostJsScope</code> 类中所有的静态方法，将它们放到一个Map中，并且生成一段js代码 </li> 
   <li> 向WebView设置 <code>InjectedChromeClient</code> ，在 <code>onProgressChanged</code> 方法中将那段js代码注入到Html5页面中，这个过程通俗点讲就是， <span>Native告诉Html 5页面，我开放了什么功能给你，你就来调用我</span> </li> 
   <li> 这样js就可以调用Native提供的这些方法，那段js代码还会将js执行的方法转换成一段json字符串，通过js的prompt方法传到 <code>onJsPrompt</code> 方法中， <code>JsCallJava</code> 调用 <code>call(WebView view, String msg)</code> 解析json字符串，包括要执行的 <strong>方法名字</strong> ， <strong>参数类型</strong> 和 <strong>方法参数</strong> ，其中还会验证json中的方法参数类型和 <code>HostJsScope</code> 中同名方法参数类型是否一致等等。 </li> 
   <li> 最后，如果方法正确执行， <code>call</code> 方法就返回一个json字符串code=200，否则就传code=500，这个信息会通过 <code>prompt</code> 方法的返回值传给js，这样Html 5 代码就能知道有没有正确执行了 </li> 
  </ol> <p> 以上就是这个开源库的整个原理，我个人觉得非常适合用于Hybrid开发，这个解决方案中js可以收到Native的返回值，而且没有使用 <code>addJavascriptInterface</code> 方法，在低版本手机上也不会有安全问题，这个方法比Cordova的实现和配置简单 </p> <p>那么当我点击Html 5页面上的一个按钮，比如弹出对话框，这个过程的整体流程是怎么样的呢</p> <h2>微信的解决方案？</h2> <p>什么？你问我微信是怎么解决的？我也反编译了微信的代码，想研究一下他们是解决的，其实我非常好奇微信的这种js 调用Native，并且又返回的调用方法</p> <p>首先，我去微信的js sdk官网看了一下js sdk提供的功能，提供了各种强大的功能，各位可以自己去看一下。那么问题来了，微信是怎么做到js 调用Native并且能够成功返回的呢？</p> <p> 带着疑问我反编译了微信Android客户端，在assers/jsapi中看到了 <code>wxjs.js</code> 文件，我想这个就是微信js sdk的源码了吧。。。 </p> <p> 我首先说一下，我不太懂js的代码， 我只能连蒙带猜的看微信的js代码， <code>如果有js大神对这方面也感兴趣，希望可以一起(jian)探(fei)讨(zao)</code> </p> <p> 在 <code>wxjs.js</code> 中看到了一下代码，我猜微信就是用这个 <code>__WeixinJSBridge</code> 当时js和Native进行通信的数据结构吧？ </p> <pre class="prettyprint sql"><code>var __WeixinJSBridge = {
<span class="indent">  </span>// public
<span class="indent">  </span>invoke:_<span class="operator"><span class="keyword">call</span>,
<span class="indent">  </span><span class="keyword">call</span>:_<span class="keyword">call</span>,
<span class="indent">  </span><span class="keyword">on</span>:_onfor3rd,
<span class="indent">  </span>env:_env,
<span class="indent">  </span><span>log</span>:_<span>log</span>,
<span class="indent">  </span>// private
<span class="indent">  </span>// _<span>test</span>_start:_<span>test</span>_start,
<span class="indent">  </span>_fetchQueue: _fetchQueue,
<span class="indent">  </span>_handleMessageFromWeixin: _handleMessageFromWeixin,
<span class="indent">  </span>_hasInit: <span><span class="keyword">false</span></span>,
<span class="indent">  </span>_<span>continue</span>SetResult: _<span>continue</span>SetResult
};</span>
</code>
</pre> <p>然后我又看到了下面的代码，我想应该是提供分享内容到朋友圈功能的吧</p> <pre class="prettyprint javascript"><code><span class="comment">// share timeline</span>
_on<span>(<span><span class="string">'menu</span></span><span class="string"><span>:share</span><span>:timeline</span>'</span>,<span class="keyword">function</span><span>(<span>argv</span>)</span>{
  _log<span>(<span><span class="string">'share</span></span><span class="string"> timeline'</span>)</span><span>;</span>
  <span class="keyword">var</span> data<span>;</span>
  <span class="keyword">if</span> <span>(<span><span class="keyword">typeof</span></span> argv.title === <span><span class="string">'string</span></span><span class="string">'</span>)</span> {
<span class="indent">  </span>data = argv<span>;</span>
<span class="indent">  </span>_call<span>(<span><span class="string">'shareTimeline</span></span><span class="string">'</span>,data)</span><span>;</span>
  }<span class="keyword">else</span>{
<span class="indent">  </span>data = {
<span class="indent">  </span><span class="indent">  </span><span class="comment">// <span>"img_url"</span>: <span>""</span>,</span>
<span class="indent">  </span><span class="indent">  </span><span class="comment">// <span>"img_width"</span>: <span>""</span>,</span>
<span class="indent">  </span><span class="indent">  </span><span class="comment">// <span>"img_height"</span>: <span>""</span>,</span>
<span class="indent">  </span><span class="indent">  </span><span><span class="string">"link"</span></span>: document.documentURI || _session_data.init_url,
<span class="indent">  </span><span class="indent">  </span><span><span class="string">"desc"</span></span>: document.documentURI || _session_data.init_url,
<span class="indent">  </span><span class="indent">  </span><span><span class="string">"title"</span></span>: document.title
<span class="indent">  </span>}<span>;</span>
<span class="indent">  </span><span class="keyword">var</span> shareFunc = <span class="keyword">function</span><span>(<span>_img</span>)</span>{		  
<span class="indent">  </span>  <span class="keyword">if</span> <span>(<span>_img</span>)</span> {
<span class="indent">  </span><span class="indent">  </span>  data[<span><span class="string">'img_url</span></span><span class="string">'</span>] = _img.src<span>;</span>
<span class="indent">  </span><span class="indent">  </span>  data[<span><span class="string">'img_width</span></span><span class="string">'</span>] = _img.width<span>;</span>
<span class="indent">  </span><span class="indent">  </span>  data[<span><span class="string">'img_height</span></span><span class="string">'</span>] = _img.height<span>;						</span>
<span class="indent">  </span>  }
<span class="indent">  </span>  _call<span>(<span><span class="string">'shareTimeline</span></span><span class="string">'</span>,data)</span><span>;</span>
<span class="indent">  </span>}<span>;</span>
<span class="indent">  </span>getSharePreviewImage<span>(<span>shareFunc</span>)</span><span>;</span>
  }
})</span><span>;</span>
</code>
</pre> <p> 请注意最后这句： <code>_call('shareTimeline',data);</code> ，在看看 <code>__WeixinJSBridge</code> 中的 <code>call</code> 属性，接着我找到了 <code>_call</code> 方法。 </p> <pre class="prettyprint cs"><code>function _call(func,<span><span class="keyword">params</span></span>,callback) {
<span class="indent">  </span><span><span class="keyword">var</span></span> curFuncIdentifier = __WeixinJSBridge.call;
<span class="indent">  </span><span><span class="keyword">if</span></span> (curFuncIdentifier !== _callIdentifier) {
<span class="indent">  </span><span class="indent">  </span><span><span class="keyword">return</span></span>;
<span class="indent">  </span>}
<span class="indent">  </span><span><span class="keyword">if</span></span> (!func || <span><span class="keyword">typeof</span></span> func !== <span><span class="string">'string'</span></span>) {
<span class="indent">  </span><span class="indent">  </span><span><span class="keyword">return</span></span>;
<span class="indent">  </span>};
<span class="indent">  </span><span><span class="keyword">if</span></span> (<span><span class="keyword">typeof</span></span> <span><span class="keyword">params</span></span> !== <span><span class="string">'object'</span></span>) {
<span class="indent">  </span><span class="indent">  </span><span><span class="keyword">params</span></span> = {};
<span class="indent">  </span>};
<span class="indent">  </span><span><span class="keyword">var</span></span> callbackID = (_callback_count++).toString();
<span class="indent">  </span><span><span class="keyword">if</span></span> (<span><span class="keyword">typeof</span></span> callback === <span><span class="string">'function'</span></span>) {
<span class="indent">  </span>  _callback_map[callbackID] = callback;
<span class="indent">  </span>};
<span class="indent">  </span><span><span class="keyword">var</span></span> msgObj = {<span><span class="string">'func'</span></span>:func,<span><span class="string">'params'</span></span>:<span><span class="keyword">params</span></span>};
<span class="indent">  </span>msgObj[_MESSAGE_TYPE] = <span><span class="string">'call'</span></span>;		
<span class="indent">  </span>msgObj[_CALLBACK_ID] = callbackID;
<span class="indent">  </span>_sendMessage(JSON.stringify(msgObj));
}
</code>
</pre> <p> 大致意思应该就是：就是将这个东西 <code>_call('shareTimeline',data);</code> 转换成一个json字符串吧，从这里看到微信的做法和上面那个开源库非常类似，简单并且安全。 <code>_call</code> 方法最后调用 <code>_sendMessage</code> 方法发送消息 </p> <pre class="prettyprint javascript"><code><span><span class="comment">//将消息添加到发送队列，iframe的准备队列为weixin://dispatch_message/</span></span>
<span><span><span class="function"><span class="keyword">function</span></span></span><span class="function"> <span><span class="title">_sendMessage</span></span><span><span class="params">(message)</span></span> {</span></span>
<span class="indent">  </span>_sendMessageQueue.push<span>(message)</span>;
<span class="indent">  </span>_readyMessageIframe.src = _CUSTOM_PROTOCOL_SCHEME + <span class="string">':<span>//'</span></span><span> + _QUEUE_HAS_MESSAGE;</span>
<span class="indent">  </span><span><span class="comment">// var ifm = _WXJS('iframe#__WeixinJSBridgeIframe')[0];</span></span>
<span class="indent">  </span><span><span class="comment">// if (!ifm) {</span></span>
<span class="indent">  </span><span><span class="comment">//   ifm = _createQueueReadyIframe(document);</span></span>
<span class="indent">  </span><span><span class="comment">// }</span></span>
<span class="indent">  </span><span><span class="comment">// ifm.src = _CUSTOM_PROTOCOL_SCHEME + '://' + _QUEUE_HAS_MESSAGE;</span></span>
};
</code>
</pre> <p> 从上面代码可以看到微信的js sdk也是将js的方法调用换成一个类似 <code>weixin://dispatch_message/</code> 这样的url，上面说的json封装的数据。那么我猜测微信的做法是类似网易云音乐的拦截url吗？如果真的是这样的话，就非常不安全了，随便一个Html 5页面可以伪造一个类似： <code>weixin://dispatch_message/</code> 这样的url来调用微信的功能了，不过好在微信对每个js调用都必须带上appid。 </p> <p>在反编译后的微信代码，我看到了下面代码：</p> <p> <img src="./谈谈Android App混合开发 _files/FnyUR3r.png!web" class="alignCenter"> </p> <p>我想这写就是微信想Html 5开放的接口吧？不过对比了一下微信js sdk的官网，我看到好多App提供的功能在js sdk中并没有找到，这样也没有太大关系，以为微信只要升级js sdk就可以使用其他功能了，因为Native已经开放了嘛~</p> <p> 从上面 <code>__WeixinJSBridge</code> 可以看到有一个熟悉 <code>_handleMessageFromWeixin</code> ，这个就是js来处理Native的回调接口，我用这个字符串在微信代码中搜索，结果如下： </p> <p> <img src="./谈谈Android App混合开发 _files/bInem2y.png!web" class="alignCenter"> </p> <p> 因此，我大致猜测，微信中的js调Native功能是用拦截url的方式，而Native回调的话是使用 <code>evaluateJavascript</code> 方法 </p> <p>我也在js sdk中找到了相应的函数：</p> <pre class="prettyprint php"><code><span><span><span class="function"><span class="keyword">function</span></span></span><span class="function"> <span><span class="title">_handleMessageFromWeixin</span></span><span class="params">(<span>message</span>)</span> </span></span><span class="function">{</span>
    <span><span class="keyword">var</span></span> curFuncIdentifier = __WeixinJSBridge._handleMessageFromWeixin;
    <span><span class="keyword">if</span></span> (curFuncIdentifier !== _handleMessageIdentifier) {
        <span><span class="keyword">return</span></span> <span><span class="string">'{}'</span></span>;
    }

    <span><span class="keyword">var</span></span> ret;
    <span><span class="keyword">var</span></span> msgWrap
    <span><span class="keyword">if</span></span> (_isUseMd5 === <span><span class="string">'yes'</span></span>) {
      <span><span class="keyword">var</span></span> realMessage = message[_JSON_MESSAGE];
      <span><span class="keyword">var</span></span> shaStr = message[_SHA_KEY];
      <span><span class="keyword">var</span></span> arr = <span><span class="keyword">new</span></span> <span><span class="keyword">Array</span></span>;
      arr[<span><span class="number">0</span></span>] = <span>JSON</span>.stringify(realMessage);
      arr[<span><span class="number">1</span></span>] = _xxyy;
      <span><span class="keyword">var</span></span> str = arr.join(<span><span class="string">""</span></span>);
      <span><span class="keyword">var</span></span> msgSha = <span><span class="string">''</span></span>;
        <span><span class="keyword">var</span></span> shaObj = CryptoJS.SHA1(str);
        msgSha = shaObj.toString();
        <span><span class="keyword">if</span></span> (msgSha !== shaStr) {
            _log(<span><span class="string">'_handleMessageFromWeixin , shaStr : '</span></span> + shaStr + <span><span class="string">' , str : '</span></span> + str + <span><span class="string">' , msgSha : '</span></span> + msgSha);
            <span><span class="keyword">return</span></span> <span><span class="string">'{}'</span></span>;

        }
        msgWrap = realMessage;
    }
    <span><span class="comment">//省略很多代码</span></span>
</code></pre> <p>微信的做法应该说非常基础，使用了原生的功能，但是安全，由于微信客户端对每一个js调用都有验证（appid），因此这也增加了一定的安全性</p> <p>以上说的都是建立在我的分析正确的情况下。</p> <h2>一些个人的想法</h2> <p> 现在各种新的技术也在想办法解决Native开发的效率问题，想用技术来解决一套代码运行在Android和iOS客户端，我相信随着技术的发展这些问题都会解决。我也好期待Facebook即将推出的 <a href="http://www.reactnativeandroid.com/" target="_blank" rel="nofollow,noindex">React Native Android</a> </p> <h2>Hybrid开发适用于哪些功能</h2> <p>本文讲的Hybrid开发就是Native客户端中嵌入了Html App的功能，这方面微信应该是做的最好的，由于Html 5的效率以及耗电问题，我个人觉得用户是不能满足Web App的体验的，Hybrid App也只适用于某些场景。一些基础的功能，比如调用手机的摄像头，获取地理位置，登录注册功能等等，做成Native的功能，让Html 5来调用更好，这样的体验也更好。</p> <p>如果你把一个登录和注册功能也做成Html 5，在弱网络环境下，这个体验应该会非常的差，或许你等半天还没加载出页面。你可能会说，我可以预先加载Html 5的代码，打开App时直接加载，那么我说你在给自己找麻烦，如果要这样的话，Native开发或许更快一点。</p> <p>那么什么情况适合Html 5开发呢？像一些活动页面，比如秒杀、团购等适合做Html 5，因为这些页面可能涉及的非常炫而且复杂，Html 5开发或许会简单点，关键是这些页面时效性短，更新更快，因为一个活动说不定就一周时间，下周换活动，如果这样的话，你还做Native是肯定不行的</p> <h2>总结</h2> <p> 有那么一句 <a href="http://mindhacks.cn/2009/01/16/hammers-and-nails/" target="_blank" rel="nofollow,noindex">古老的箴言</a> ： </p> 
  <div> 
   <p>如果你手里有一把锤子，所有东西看上去都想钉子</p> 
  </div> <p> 千万不要以为Hybrid开发能够夸平台运行，就使用Hybrid开发任何功能。其实Facebook早期也是这么想的，后来就是因为WebView渲染效率底下，把整个应用改为Native开发，请看 <a href="https://www.facebook.com/notes/facebook-engineering/under-the-hood-rebuilding-facebook-for-android/10151189598933920" target="_blank" rel="nofollow,noindex">这里</a> </p> <p>引用Facebook的一段话：</p> 
  <div> 
   <p>Today, we’re releasing a new version of Facebook for Android that’s been rebuilt in native code to improve speed and performance. To support the unique complexity of Facebook stories across devices, we’re moving from a hybrid native/webview to pure native code, allowing us to optimize the Facebook experience for faster loading, new user interfaces, disk cache, and so on.</p> 
  </div> <p>本文主要还是从技术上谈谈Hybrid开发中js和Native交互的技术实现原理。抛砖引玉，写的估计也有很多错的，希望技术大牛指出。</p> <p>最后，我觉得那个开源的库是一个非常不错的解决方案，解决办法巧妙、简单而且安全。当时我debug了半天弄明白其中的原理后，我一拍大腿，这办法真好啊！！网易云音乐的解决办法适用于它的场景，不需要回调，Native只需要处理相应的信息，然后来实现页面跳转、播放音乐、播放MV等功能，这个方法也简单好用。</p> </span> 
</div>
        </div>
        <div class="article_social">
         <div class="article_like">
    <div class="circle circle-like" id="my_zan" data_id="m6RVFfA">  </div>

</div>
        <div id="share_weixin_image">
            <img width="100px" height="100px" src="./谈谈Android App混合开发 _files/qrcode.php">
        </div>
<div class="article_share_fav">
    <div class="share" id="ckepop">
        <span>分享</span>
        <button class="share_weibo" id="share_weibo_id" title="分享到新浪微博"></button>
        <button class="share_qq" id="share_qq_id" title="分享到QQ空间"></button>
        <button class="share_weixin" id="share_weixin_id"></button>
    </div>
    <div class="fav_correct">
        <button id="my_fav" data_id="m6RVFfA">
            <i class="icon icon-star-empty"></i> <span id="fav_tip">收藏</span>
        </button>
        <button id="article-correct" data_id="m6RVFfA" uid="0">
            <i class="icon icon-warning-sign"></i>
            <span>纠错</span>
        </button>
    </div>
</div>
<script type="text/javascript">
$("#share_weibo_id").click( function() {
   window.open("http://share.baidu.com/s?type=text&searchPic=0&sign=on&to=tsina&url=http://www.tuicool.com/articles/m6RVFfA&title=%E8%B0%88%E8%B0%88Android+App%E6%B7%B7%E5%90%88%E5%BC%80%E5%8F%91++%28%E5%88%86%E4%BA%AB%E8%87%AA+%40%E6%8E%A8%E9%85%B7%E7%BD%91%29&key=3113829255");
});
$("#share_qq_id").click( function() {
   window.open("http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http://www.tuicool.com/articles/m6RVFfA&title=%E8%B0%88%E8%B0%88Android+App%E6%B7%B7%E5%90%88%E5%BC%80%E5%8F%91&desc=&summary=&site=");
});
$("#share_weixin_id").click( function() {
  $("#share_weixin_image").toggle();
});
</script>


            <div class="bottom_ad huodong-detail-ad-banner clearfix">
                  <a href="https://www.jiguang.cn/?from=tuicool01" target="_blank"><img src="./谈谈Android App混合开发 _files/jpush700.jpg"></a>

            </div>
        </div>
        <div id="site_articles" style="clear:both;">
              <div class="article-part-title">
                <span>推荐文章</span>
              </div>
          <ul class="side_article_list">
                <li class="side_article_list_item">
                    1.<a href="http://www.tuicool.com/articles/6byEneN" target="_blank" title="D3 源代码解析（二）">
                    D3 源代码解析（二）
                    </a>
                </li>
                <li class="side_article_list_item">
                    2.<a href="http://www.tuicool.com/articles/feiayiq" target="_blank" title="javascript中那些折磨人的面试题">
                    javascript中那些折磨人的面试题
                    </a>
                </li>
                <li class="side_article_list_item">
                    3.<a href="http://www.tuicool.com/articles/uyaqMbv" target="_blank" title="jquery动画之queue和dequeue">
                    jquery动画之queue和dequeue
                    </a>
                </li>
                <li class="side_article_list_item">
                    4.<a href="http://www.tuicool.com/articles/feAzmij" target="_blank" title="在Node.js测试中Mock文件系统">
                    在Node.js测试中Mock文件系统
                    </a>
                </li>
                <li class="side_article_list_item">
                    5.<a href="http://www.tuicool.com/articles/uuArimV" target="_blank" title="每日一博 | AngularJS 指令实践">
                    每日一博 | AngularJS 指令实践
                    </a>
                </li>
                <li class="side_article_list_item">
                    6.<a href="http://www.tuicool.com/articles/jEVNRbY" target="_blank" title="Node.js学习笔记：读写流Stream">
                    Node.js学习笔记：读写流Stream
                    </a>
                </li>
          </ul>
        </div>
        <div id="kan_articles"> <div class="article-part-title"> <span>相关推刊</span></div><ul class="kan-list">          <li class="kan-item">            <a href="http://www.tuicool.com/kans/3765419152" target="_blank" class="kan-item-head">              <small>by jacktom</small>              <img class="kan-cover" src="./谈谈Android App混合开发 _files/yQZv2yE.jpg!kan">            </a>            <span class="kan-detail">              <a href="http://www.tuicool.com/kans/3765419152" target="_blank">《默认推刊》</a>              <i class="kan-num">55</i>            </span>          </li>                  <li class="kan-item">            <a href="http://www.tuicool.com/kans/2409166112" target="_blank" class="kan-item-head">              <small>by tianqishu11</small>              <img class="kan-cover" src="./谈谈Android App混合开发 _files/qqimUzm.png!kan">            </a>            <span class="kan-detail">              <a href="http://www.tuicool.com/kans/2409166112" target="_blank">《默认推刊》</a>              <i class="kan-num">2</i>            </span>          </li>                  <li class="kan-item">            <span class="kan-item-head">              <small></small>              <img class="kan-cover" src="./谈谈Android App混合开发 _files/qqimUzm.png!kan">            </span>            <span class="kan-detail">              <i>《匿名收藏》</i>              <i class="kan-num">1</i>            </span>          </li>        </ul><i class="clearfix"></i></div>
        <div id="article_weibo" style="display:none;">
            <div class="article-part-title">
                <span>相关微博</span>
                <sub>
                    <a href="http://www.tuicool.com/articles/weibo_list/m6RVFfA" target="_blank">(<i id="weibo_num"></i>)</a> 
               </sub>
            </div>
            <div class="related-weibo-list"></div>
        </div>
        <div class="comments">
    <div class="comments-area">
    <div class="comments-header">
        <h5>我来评几句</h5>
        <div class="alert comment-alert alert-error" style="display:none;">
            错误
        </div>
            <textarea cols="60" rows="5" id="comment-body" placeholder="请输入评论内容..." style="resize: none;"></textarea>
            <span class="btn btn-medium btn-submit" id="comment-submit">登录后评论</span>
        <p style="margin-top: 5px;margin-left:10px;">
            已发表评论数(<span class="comment_cnt">0</span>)
        </p>
    </div>
    <div class="comments-list">
        <div class="empty-cmts alert alert-success" style="display:none;">
            没有更多评论了^^
        </div>
    </div>
    <div class="more-comments" style="display:none;">
        <a href="">更多评论</a>
    </div>
    <div class="load-fail" style="display: none;">
        评论加载失败，<a href="javascript:reload_comments('m6RVFfA',1,0,-1);">重新加载</a>
    </div>
    </div>
</div>

    </div>
        <div class="span4 article_right_side">
            <div class="right_top">
    <div class="article_related_site article_detail_bg">
    <h4 class="article-part-title">相关站点</h4>
    <div class="article_related_site_body clearfix">
        <div class="logo">
            <img src="./谈谈Android App混合开发 _files/zeYFF3.png">
        </div>
        <div class="name">
            <div>
                <a href="http://www.tuicool.com/sites/zeYFF3" target="_blank"> bxbxbai</a>
            </div>
            <div>
                <div class="btn btn-success right_site_follow" id="my_follow" data_id="zeYFF3">＋订阅</div>
            </div>
        </div>
    </div>
</div>

<div id="right_site_articles" class="article_detail_bg">
    <div class="article-part-title">
        <span>热门文章</span>
    </div>
    <ul class="side_article_list">
        <li class="side_article_list_item">
            1.<a href="http://www.tuicool.com/articles/6byEneN" target="_blank" title="D3 源代码解析（二）"> D3 源代码解析（二） </a>
        </li>
        <li class="side_article_list_item">
            2.<a href="http://www.tuicool.com/articles/feiayiq" target="_blank" title="javascript中那些折磨人的面试题"> javascript中那些折磨人的面试题 </a>
        </li>
        <li class="side_article_list_item">
            3.<a href="http://www.tuicool.com/articles/jEVNRbY" target="_blank" title="Node.js学习笔记：读写流Stream"> Node.js学习笔记：读写流Stream </a>
        </li>
        <li class="side_article_list_item">
            4.<a href="http://www.tuicool.com/articles/uyaqMbv" target="_blank" title="jquery动画之queue和dequeue"> jquery动画之queue和dequeue </a>
        </li>
        <li class="side_article_list_item">
            5.<a href="http://www.tuicool.com/articles/feAzmij" target="_blank" title="在Node.js测试中Mock文件系统"> 在Node.js测试中Mock文件系统 </a>
        </li>
    </ul>
</div>


      <div class="right-ad">
              <a href="https://www.jiguang.cn/?from=tuicool01" target="_blank"><img src="./谈谈Android App混合开发 _files/jpush120.jpg"></a>

      </div>
      <div class="right-ad" style="margin-top: 5px">
              <a href="https://www.teambition.com/?utm_source=tuicool&utm_medium=banner01" target="_blank"><img src="./谈谈Android App混合开发 _files/teambition120.jpg"></a>

      </div>
      <div class="right-ad" style="margin-top: 5px">
              <a href="http://www.daocloud.io/cloud/voice.html" target="_blank"><img src="./谈谈Android App混合开发 _files/daocloud300.jpg"></a>

      </div>
<div class="right-ad" style="margin-top: 5px">
      <a href="http://click.aliyun.com/m/5327/" target="_blank"><img src="./谈谈Android App混合开发 _files/aliyun120.jpg"></a>

</div>
      <div class="right-ad" style="margin-top: 5px">
              <a href="http://www.jiankongbao.com/?f=tuicool" target="_blank"><img src="./谈谈Android App混合开发 _files/jiankongbao120.jpg"></a>

      </div>
<div class="right-ad" style="margin-top: 5px">
      <a href="http://www.handone.com/?f=tc" target="_blank"><img src="./谈谈Android App混合开发 _files/handone300.jpg"></a>

</div>
<div class="right-ad" style="margin-top: 5px">
      <a href="http://www.vc3market.com/?f=tc" target="_blank"><img src="./谈谈Android App混合开发 _files/vc3market120.jpg"></a>

</div>
</div>
<div class="operate_zone" style="position: fixed; top: 50px;">
      <div class="right-ad" style="margin-top: 0px">
              <a href="http://www.faisco.com/pro8.html?_ta=2160" target="_blank"><img src="./谈谈Android App混合开发 _files/faisco120.jpg"></a>

      </div>
        <div class="frd_pos">
        <script async="" src="./谈谈Android App混合开发 _files/adsbygoogle.js"></script>
<ins class="adsbygoogle" style="display:inline-block;width:300px;height:250px" data-ad-client="ca-pub-7054762349007490" data-ad-slot="5705695566"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

        </div>
</div>
         </div>
</div>

<div>
   <!-- add_article to kan -->
<div id="add-article-to-kan" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <span class="add-title">收藏到推刊</span>
    <a href="http://www.tuicool.com/articles/m6RVFfA#new-kan" class="btn pull-right" data-toggle="modal">创建推刊</a>
    <i class="clearfix"></i>
  </div>
  <div class="modal-body">
    <ul id="add-kan-list">
    </ul>
  </div>
  <div class="modal-footer">
    <input type="hidden" value="m6RVFfA" class="article-id"> 
    <button class="btn btn-primary pull-left add-to-btn">  收 藏  </button>
    <button class="btn" data-dismiss="modal" aria-hidden="true" style="margin-right: 15px">取消</button>
  </div>
</div>

   <div id="new-kan" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-body">
    <input type="text" name="name" id="new-kan-name" placeholder="推刊名(必填)" required="" data-validation-required-message="请填写推刊名">
    <span class="new-ness-name">请填写推刊名</span>
    <br>
    <textarea name="desc" id="desc" rows="6" placeholder="推刊描述"></textarea>
    <span class="new-ness-desc">描述不能大于100个字符!</span>
    <br>
    权限设置：<input type="radio" name="type" value="1" checked="checked"> 公开
    <input type="radio" name="type" value="0"> 仅自己可见
  </div>
  <div class="modal-footer">
    <button class="btn btn-primary pull-left create-kan-btn" disabled="">创建</button>
    <button class="btn dismiss-new-kan" data-dismiss="modal" aria-hidden="true">取消</button>
  </div>
</div>


</div>
<div id="article-correct-modal" class="modal hide fade in" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="false">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
            ×
        </button>
        <h3>文章纠错</h3>
    </div>
    <div class="modal-body">
        <input type="hidden" value="m6RVFfA" id="article-correct-source">
        <div>
            <label for="article-correct-email">
                邮箱地址
            </label>
            <input type="email" id="article-correct-email" class="input-large">
        </div>
        <div>
            <label for="article-correct-select">
                错误类型
            </label>
            <select id="article-correct-select">
                <option value="正文不准确">正文不准确</option>
                <option value="标题不准确">标题不准确</option>
                <option value="排版有问题">排版有问题</option>
                <option value="排版有问题">主题不准确</option>
                <option value="没有分页内容">没有分页内容</option>
                <option value="图片无法显示">图片无法显示</option>
                <option value="视频无法显示">视频无法显示</option>
                <option value="与原文不一致">与原文不一致</option>
            </select>
        </div>
        <div>
            <label for="article-correct-other">
                补充信息
            </label>
            <textarea id="article-correct-other" class="span4"></textarea>
        </div>
    </div>
    <div class="modal-footer">
        <button class="btn btn-primary pull-right huodong_correct_submit" id="article-correct-submit">
            &nbsp;&nbsp;提交&nbsp;&nbsp;
        </button>
    </div>
</div>

<style type="text/css">
    .btn-large {
        padding: 0;
    }
    .load-fail {
        display: none;
    }
</style>
<script src="./谈谈Android App混合开发 _files/highlight.pack.js"></script>
<script type="text/javascript">
    $('table').each(function(i) {
        var size = $(this).children().size();
        if (size > 1) {
            $(this).attr('class',"table table-bordered");
        } else if (size == 1) {
            var e11 = $(this).children(":first");
            var e1 = e11[0];
            var name = e1.nodeName.toLowerCase();
            if ("tbody" == name) {
                if (e1.children.length > 1) {
                    $(this).attr('class',"table table-bordered");
                } else if (e1.children.length == 1){
                    var e12 = e1.children[0];
                    var name2 = e12.nodeName.toLowerCase();
                    if ("tr" == name2) {
                       if (e12.children.length > 1) {
                         $(this).attr('class',"table table-bordered");
                       }
                    }
                }
            }
        }
    });
            related_kan("m6RVFfA");
        window.page = 0;
        window.last = 0;    
        window.first = true;
        resize_article_image('#nei', 550);
                load_comments("m6RVFfA",1,0,-1);
                window.uid = -1;
        open_add_article_to_kan("false");
        async_do_zan_article(); 
        $('pre').each(function(i, e) {
            hljs.highlightBlock(e, "<span class='indent'>  </span>", false)
        });
       
          
       handle_follow_site("#my_follow","已订阅","+ 订阅");
</script>


    <div class="loader-inner ball-pulse ball-loading-center" id="page-loading" style="display: none">
      <div></div>
      <div></div>
      <div></div>
    </div>
    <div class="read-later-alert"></div>
  </div>

    <div class="footer">
    <div class="footer-inner">
    <dl class="about-link site-link">
        <dt>
            网站相关
        </dt>
        <dd>
            <a target="_blank" href="http://www.tuicool.com/about">关于我们</a>
        </dd>
        <dd>
            <a target="_blank" href="http://www.tuicool.com/mobile">移动应用</a>
        </dd>
        <dd>
            <a target="_blank" href="http://www.tuicool.com/bbs/go/issues">建议反馈</a>
        </dd>
    </dl>
    <dl class="site-link follow-link">
        <dt>
            关注我们
        </dt>
        <dd>
            <a target="_blank" href="http://e.weibo.com/tuicool2012"><img src="./谈谈Android App混合开发 _files/weibo-32.png">推酷网</a>
        </dd>
        <dd><img src="./谈谈Android App混合开发 _files/weixin-32.png">tuicool2012
        </dd>
    </dl>
    <dl class="site-link links">
        <dt>
            友情链接
        </dt>
        <dd>
                <a href="http://www.woshipm.com/" title="人人都是产品经理" target="_blank">人人都是产品经理</a>
                <a href="http://www.pm265.com/" title="PM256" target="_blank">PM256</a>
                <a href="http://www.yidonghua.com/" title="移动信息化" target="_blank">移动信息化</a>
                <a href="http://www.snsiu.com/" title="行晓网" target="_blank">行晓网</a>
                <a href="http://www.taskcity.com/" title="智城外包网" target="_blank">智城外包网</a>
                <a href="http://www.huxiu.com/" title="虎嗅" target="_blank">虎嗅</a>
                <a href="http://www.iterduo.com/" title="IT耳朵" target="_blank">IT耳朵</a>
                <a href="http://mediaworks.caixin.com/" title="创媒工场" target="_blank">创媒工场</a>
                <a href="http://www.managershare.com/" title="经理人分享" target="_blank">经理人分享</a>
                <a href="http://www.shichangbu.com/" title="市场部网" target="_blank">市场部网</a>
                <a href="http://www.ikanchai.com/" title="砍柴网" target="_blank">砍柴网</a>
                <a href="http://www.cocoachina.com/" title="CocoaChina" target="_blank">CocoaChina</a>
                <a href="http://www.ibeifeng.com/" title="北风网" target="_blank">北风网</a>
                <a href="http://www.jiankongbao.com/" title="云智慧" target="_blank">云智慧</a>
                <a href="http://www.wyzc.com/" title="我赢职场" target="_blank">我赢职场</a>
                <a href="http://www.thebigdata.cn/" title="大数据时代" target="_blank">大数据时代</a>
                <a href="http://www.qidic.com/" title="奇笛网" target="_blank">奇笛网</a>
                <a href="http://www.cngulu.com/" title="咕噜网" target="_blank">咕噜网</a>
                <a href="http://www.linuxdiyf.com/" title="红联linux" target="_blank">红联linux</a>
                <a href="http://win10.ithome.com/" title="Win10之家" target="_blank">Win10之家</a>
                <a href="http://www.niaogebiji.com/" title="鸟哥笔记" target="_blank">鸟哥笔记</a>
                <a href="http://www.play.cn/" title="爱游戏" target="_blank">爱游戏</a>
                <a href="http://www.investide.cn/" title="投资潮" target="_blank">投资潮</a>
                <a href="http://www.31huiyi.com/" title="31会议网" target="_blank">31会议网</a>
                <a href="https://www.jiguang.cn/" title="极光推送" target="_blank">极光推送</a>
                <a href="https://www.teambition.com/" title="Teambition" target="_blank">Teambition</a>
                <a href="http://www.guigu.org/" title="硅谷网" target="_blank">硅谷网</a>
                <a href="https://home.leangoo.com/" title="leangoo" target="_blank">leangoo</a>
                <a href="http://www.zealer.com/" title="ZEALER中国" target="_blank">ZEALER中国</a>
                <a href="http://www.opensns.cn/" title="OpenSNS" target="_blank">OpenSNS</a>
                <a href="http://www.edu360.cn/" title="小牛学堂" target="_blank">小牛学堂</a>
                <a href="http://www.handone.com/" title="handone" target="_blank">handone</a>
                <a href="http://www.scrumcn.com/" title="Scrum中文网" target="_blank">Scrum中文网</a>
                <a href="http://www.bigniu.com/" title="比戈大牛" target="_blank">比戈大牛</a>
                <a href="https://www.upyun.com/" title="又拍云" target="_blank">又拍云</a>
            <a href="http://www.tuicool.com/links">更多链接&gt;&gt;</a>&nbsp;&nbsp;
        </dd>
    </dl>
    <div class="clear"></div>
    </div>
</div>

<div style="display:none;">
   <script src="./谈谈Android App混合开发 _files/stat.php" language="JavaScript"></script><script src="./谈谈Android App混合开发 _files/core.php" charset="utf-8" type="text/javascript"></script><a href="http://www.cnzz.com/stat/website.php?web_id=5541078" target="_blank" title="站长统计"><img border="0" hspace="0" vspace="0" src="./谈谈Android App混合开发 _files/pic.gif"></a>
</div>




<div class="return" title="返回顶部" style="display: block;"></div><div id="__nightingale_view_cover" style="width: 100%; height: 100%; -webkit-transition: -webkit-transform 10s ease-in-out; transition: -webkit-transform 10s ease-in-out; position: fixed !important; left: 0px !important; bottom: 0px !important; overflow: hidden !important; pointer-events: none !important; z-index: 2147483647; opacity: 0; background: rgb(0, 0, 0) !important;"></div><div class="sogoutip" style="z-index: 2147483645; visibility: hidden; display: none;"></div><div class="sogoubottom" id="sougou_bottom" style="display: none;"></div><div id="ext_stophi" style="z-index: 2147483647;"><div class="extnoticebg"></div><div class="extnotice"><h2>关闭提示 <a href="http://www.tuicool.com/articles/m6RVFfA#" title="关闭提示" id="closenotice" class="closenotice">关闭</a></h2><p id="sogouconfirmtxt"></p>  <a id="sogouconfirm" href="http://www.tuicool.com/articles/m6RVFfA#" class="extconfirm">确 认</a> <a id="sogoucancel" href="http://www.tuicool.com/articles/m6RVFfA#" class="extconfirm">取 消</a></div></div><div id="ext_overlay" class="ext_overlayBG" style="display: none; z-index: 2147483646;"></div><iframe class="sogou_sugg_feedbackquan" frameborder="0" scrolling="no" src="./谈谈Android App混合开发 _files/yun4.html" style="border: none; display: none; z-index: 2147483645; background: transparent;"></iframe><div class="rec-mini" id="id_div_close" style="display: none; z-index: 2147483645; width: 53px; height: 53px; position: fixed; right: 7px; bottom: 7px; cursor: pointer; background: url(http://ht.www.sogou.com/images/mini.png) no-repeat;"></div><script src="./谈谈Android App混合开发 _files/pv.gif"></script><div id="yass_bottom_edge" style="position: absolute; margin: 0px; padding: 0px; border-width: 0px; height: 0px; left: 0px; top: 0px; width: 100%; display: block; background-image: url(se-extension://ext-1528535222/edgebgbot.png); background-position: 0px 0px;"></div></body></html>